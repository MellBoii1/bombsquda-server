<!DOCTYPE html>
<html>
<head>
    <title>BombSquda Leaderboard</title>
    <link rel="icon" type="image/x-icon" href="static/favicon.ico">
    <meta content="BombSquda Leaderboard" property="og:title"/>
	<meta name="twitter:card" content="summary_large_image">
    <style>
		.a2 {
			/* Set display to inline-block so transform works */
			display: inline-block; 
			
			/* Smooths the scaling effect */
			transition: transform 0.2s ease-in-out; 
			
			/* Optional: additional styling */
			padding: 10px 15px;
			color: #000;
			text-decoration: none;
		}
		/* unvisited link */
		.a2:link {
		  color: white;
		  background-color: transparent;
		  text-decoration: none; /* optional: removes underline */
		}

		/* visited link */
		.a2:visited {
		  color: white;
		  background-color: transparent;
		  text-decoration: none;
		}

		/* mouse over link */
		.a2:hover {
		  color: green;
		  background-color: transparent;
		  text-decoration: none; /* optional: adds underline on hover */
		  transform: scale(1.1);
		}

		/* selected link */
		.a2:active {
		  color: lime;
		  background-color: transparent;
		  text-decoration: none;
		  transform: scale(1.4);
		  transition: transform 0.1s ease-in-out; 
		}
		@font-face {
			font-family: 'bombsquad';
			src: url('static/hobo.ttf') format('truetype');
			font-weight: light;
			font-style: normal;
		}
        body {
            background:	#103211;
            color: #98d09f;
            font-family: 'bombsquad', sans-serif;
			background-image: url('static/background.png');
			background-size: cover;
            text-align: center;
            padding: 40px;
        }

        h1 {
            color: #d0f7d1;
        }

        .box {
            background: #103211;
            padding: 20px;
            border-radius: 12px;
            width: 500px;
            margin: auto;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        .entry {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            border-bottom: 1px solid #333;
        }

        .entry:last-child {
            border-bottom: none;
        }

        .time {
            color: #98d09f;
        }
    </style>
</head>
<body>
	<h2><a href="/" class="a2"><- Go Back</a></h2>
    <h1>Speedrun Leaderboard</h1>
	<h2>This is the leaderboard for players' best times in co-op levels!</h2>

    <div class="box" id="board">
        Loading...
    </div>

	<script>
	fetch("/get/all")
		.then(r => r.json())
		.then(data => {
			const board = document.getElementById("board");
			board.innerHTML = "";

			for (const level in data) {
				const h2 = document.createElement("h2");
				h2.textContent = prettifyLevelName(level);
				board.appendChild(h2);

				const entries = data[level];

				const sorted = Object.entries(entries)
					.sort((a, b) => a[1] - b[1]);

				for (const [player, time] of sorted) {
					const row = document.createElement("div");
					row.className = "entry";

					row.innerHTML = `
						<span>${player}</span>
						<span class="time">${formatTime(time)}</span>
					`;

					board.appendChild(row);
				}
			}
		});

	function formatTime(t) {
		const m = Math.floor(t / 60);
		const s = Math.floor(t % 60);
		const ms = Math.floor((t - Math.floor(t)) * 1000);
		return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}:${ms.toString().padStart(3, '0')}`;
	}
	function prettifyLevelName(raw) {
    return raw
        .replace(/^Default:/, "Hard: ") // replace Default with Hard
        .replace(/^Easy:/, "Easy: ") // replace Easy with... easy i guess
        .replace(/_squdaPB$/, ""); 
	}
	</script>
</body>
</html>
